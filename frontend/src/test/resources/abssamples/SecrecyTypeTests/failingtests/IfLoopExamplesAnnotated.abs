module LoopInvariantExample;

class IFLoopExamples {
	[Secrecy: Low] Int low = 0;

    Unit hammer([Secrecy: High] Int secret) {
        [Secrecy: High] Int x = 0;
        Int y = 0;
            
        while (y < 10) {

            this.print(x);
            
			if (y == 5) {
                x = secret; 
                y = 9;
            }
            
			x = x+1;
            y = y+1;
            
		}
    }

    Unit print(Int x) {
        low = x;
    }

	Unit secure_while(Int x) {

		while (x > 0) {
			low = low + 1;
			x = x - 1;
		}
	}

	Unit loc_secure_while(Int x) {
		Int z = 2;
		
		while (x > 0) {
			low = low + 1;
			x = x - 1;
			z = z + x;
		}
	}

	Unit secure_twoWhile(Int x) {

		while (x > 0) {
			low = low + 1;
			x = x - 1;
		}

		while (x == 0) {
			low = low + 1;
			x = x - 1;
		}
	}

	Unit insecure_twoWhile_2([Secrecy: High] Int x) {

		while (x > 0) {
			low = low + 1;
			x = x - 1;
		}

		while (x == 0) {
			low = low + 1;
			x = x - 1;
		}
	}

	Unit insecure_twoWhile([Secrecy: High] Int x) {

		while (x > 0) {
			low = low + 1;
			x = x - 1;
		}

		while (x == 0) {
			low = low + 1;
			x = x - 1;
		}
	}


	Unit notSecure_while_wrongInv([Secrecy: High] Int x) {

		while (x > 0) {
			low = low + 1;
			x = x - 1;
		}
	}

	Unit notSecure_while([Secrecy: High] Int x) {

		while (x > 0) {
			low = low + 1;
			x = x - 1;
		}
	}

	Unit secure_nestedWhile(Int x) {

		while (x > 0) {
			
			low = low + 1;
			x = x - 1;
			
			while (x > 0) {
				low = low + 1;
				x = x - 1;				
			}
		}
	}

	Unit secure_nestedTwoWhile(Int x) {

		while (x > 0) {
			low = low + 1;
			x = x - 1;

			while (x > 0) {
				low = low + 1;
				x = x - 1;				
			}

			while (x > 0) {
				low = low + 1;
				x = x - 1;				
			}
		}
	}

	Unit secure_doubleNestedWhile(Int x) {

		while (x > 0) {
			low = low + 1;
			x = x - 1;

			while (x > 0) {
				low = low + 1;
				x = x - 1;

				while (x > 0) {
					low = low + 1;
					x = x - 1;
				}				
			}
		}
	}

	Unit insecure_doubleNestedWhile([Secrecy: High] Int x) {

		while (x > 0) {
			low = low + 1;
			x = x - 1;

			while (x > 0) {
				low = low + 1;
				x = x - 1;

				while (x > 0) {
					low = low + 1;
					x = x - 1;
				}
			}
		}
	}

	Unit insecure_doubleNestedWhile2([Secrecy: High] Int x) {

		while (x > 0) {
			low = low + 1;
			x = x - 1;

			while (x > 0) {
				low = low + 1;
				x = x - 1;

				
				while (x > 0) {
					low = low + 1;
					x = x - 1;
				}
			}
		}
	}
        
    Unit secure_while_4(Int x) {
        low = low + 1;

        while (x > 0) {
            low = low + 1;
            x = x - 1;
        }

        low = low + 1;
    }

    Unit secure_while_2(Int x) {
        low = low + 1;
        
		while (x > 0) {
                low = low + 1;
                x = x - 1;
        }
        
		low = low + 1;
    }

    Unit insecure_while_3([Secrecy: High] Int x) {
        low = low + 1;
        
		while (x > 0) {
            low = low + 1;
            x = x - 1;
        }
        
		low = low + 1;
    }
}